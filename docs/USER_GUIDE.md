# 用户指南

欢迎使用Excel批量批注插件！本指南将帮助您快速掌握插件的各项功能。

## 目录

- [快速开始](#快速开始)
- [主要功能](#主要功能)
- [详细使用说明](#详细使用说明)
- [高级功能](#高级功能)
- [最佳实践](#最佳实践)
- [常见问题](#常见问题)

## 快速开始

### 第一次使用

1. **启动插件**
   - 在Excel中点击快速访问工具栏的"批量批注"按钮
   - 或在开发工具菜单中选择"批量批注工具"

2. **基本操作**
   - 选择要添加批注的单元格区域
   - 选择批注来源（单元格、固定文本或文件）
   - 设置批注格式
   - 点击"确定"开始处理

### 5分钟快速教程

让我们通过一个简单的例子来了解插件的基本用法：

1. **准备数据**
   ```
   A1: 产品名称    B1: 销售额
   A2: 产品A      B2: 1000
   A3: 产品B      B3: 2000
   A4: 产品C      B4: 1500
   ```

2. **添加批注**
   - 选择区域 B2:B4
   - 选择"固定文本"
   - 输入：销售额：{VALUE}元
   - 点击确定

3. **查看结果**
   - B2单元格批注：销售额：1000元
   - B3单元格批注：销售额：2000元
   - B4单元格批注：销售额：1500元

## 主要功能

### 1. 批量添加批注

- **支持大规模数据处理**：一次可处理数千个单元格
- **多种数据源**：支持从单元格、固定文本、外部文件获取批注内容
- **智能匹配**：自动匹配目标区域和数据源

### 2. 灵活的格式设置

- **字体设置**：字体名称、大小、颜色
- **样式设置**：粗体、斜体
- **大小控制**：固定大小或自动调整

### 3. 模板管理

- **预设模板**：提供常用的批注模板
- **自定义模板**：创建和保存个人模板
- **模板导入导出**：与他人分享模板

### 4. 占位符支持

- **动态内容**：使用占位符插入动态信息
- **丰富的占位符**：单元格地址、值、行列号、日期时间等

## 详细使用说明

### 批量批注对话框

#### 目标区域设置

1. **手动输入**
   - 在"目标区域"文本框中输入区域地址
   - 例如：A1:B10、Sheet1!A1:B10

2. **选择区域**
   - 点击"选择"按钮
   - 在工作表中选择目标区域
   - 支持多个不连续区域

#### 批注来源选择

##### 来自单元格

最常用的方式，从其他单元格获取批注内容。

**使用场景**：
- 产品说明表中的详细描述
- 备注信息表中的说明文字
- 计算公式的解释说明

**操作步骤**：
1. 选择"来自单元格"选项
2. 点击"选择"按钮选择数据源区域
3. 确保数据源区域与目标区域大小匹配

**示例**：
```
目标区域：A1:A3
数据源：  B1:B3 (包含批注文本)
结果：    A1的批注来自B1，A2的批注来自B2，A3的批注来自B3
```

##### 固定文本

所有目标单元格使用相同的批注内容。

**使用场景**：
- 统一的说明信息
- 警告或提示信息
- 数据来源说明

**操作步骤**：
1. 选择"固定文本"选项
2. 在文本框中输入批注内容
3. 可以使用占位符实现动态内容

**占位符示例**：
```
输入：数据更新时间：{DATE} {TIME}
结果：数据更新时间：2024-01-01 14:30:25
```

##### 从文件导入

从外部文件读取批注内容。

**支持的文件格式**：
- **文本文件(.txt)**：每行一个批注
- **CSV文件(.csv)**：表格形式的批注数据
- **Excel文件(.xlsx/.xls)**：从其他Excel文件导入

**操作步骤**：
1. 选择"从文件导入"选项
2. 点击"浏览"选择文件
3. 插件会自动解析文件内容

**文件格式示例**：

*文本文件 (comments.txt)*：
```
这是第一个批注
这是第二个批注
这是第三个批注
```

*CSV文件 (comments.csv)*：
```
批注1,批注2
批注3,批注4
```

#### 格式设置

##### 模板选择

1. **使用预设模板**
   - 从下拉列表选择模板
   - 自动应用模板的所有格式设置

2. **自定义格式**
   - 手动设置各项格式参数
   - 可以基于模板进行微调

##### 字体设置

- **字体名称**：支持系统中安装的所有字体
- **字体大小**：6-72磅，推荐9-12磅
- **字体颜色**：预设常用颜色，支持自定义
- **字体样式**：粗体、斜体可独立设置

##### 大小设置

- **自动调整**：根据内容自动调整批注大小
- **固定大小**：指定批注的宽度和高度
- **最大限制**：自动调整时的最大尺寸限制

### 模板管理器

#### 创建新模板

1. **打开模板管理器**
   - 在批量批注对话框中点击"模板管理"

2. **新建模板**
   - 点击"新建"按钮
   - 输入模板名称
   - 设置各项格式参数
   - 点击"保存"

3. **模板属性**
   - **名称**：模板的唯一标识
   - **字体设置**：字体名称、大小、颜色、样式
   - **默认文本**：模板的默认批注内容
   - **大小设置**：批注的尺寸设置

#### 编辑现有模板

1. **选择模板**
   - 在模板列表中选择要编辑的模板

2. **修改设置**
   - 点击"编辑"按钮
   - 修改模板属性
   - 点击"保存"确认更改

#### 导入导出模板

1. **导出模板**
   - 选择要导出的模板
   - 点击"导出"按钮
   - 选择保存位置

2. **导入模板**
   - 点击"导入"按钮
   - 选择模板文件(.bct格式)
   - 模板会自动添加到列表中

## 高级功能

### 占位符详解

占位符允许您在批注中插入动态内容，使批注更加智能和有用。

#### 基本占位符

| 占位符 | 说明 | 示例 |
|--------|------|------|
| {CELL} | 单元格地址 | A1, B2, Sheet1!C3 |
| {VALUE} | 单元格值 | 100, "文本", 2024-01-01 |
| {ROW} | 行号 | 1, 2, 3 |
| {COLUMN} | 列号 | 1, 2, 3 |
| {SHEET} | 工作表名称 | Sheet1, 数据表 |
| {WORKBOOK} | 工作簿名称 | 报表.xlsx |

#### 日期时间占位符

| 占位符 | 说明 | 示例 |
|--------|------|------|
| {DATE} | 当前日期 | 2024-01-01 |
| {TIME} | 当前时间 | 14:30:25 |
| {DATETIME} | 日期时间 | 2024-01-01 14:30:25 |

#### 系统信息占位符

| 占位符 | 说明 | 示例 |
|--------|------|------|
| {USER} | 当前用户名 | Administrator |
| {COMPUTER} | 计算机名 | DESKTOP-ABC123 |

#### 占位符使用示例

```
模板：单元格{CELL}的值为{VALUE}，由{USER}在{DATE}更新
结果：单元格A1的值为1000，由张三在2024-01-01更新
```

### 批处理模式

对于大量数据的处理，插件提供了优化的批处理模式：

#### 性能优化

- **分批处理**：大数据集自动分批处理，避免内存溢出
- **进度显示**：实时显示处理进度和剩余时间
- **后台处理**：不阻塞Excel界面，可以取消操作

#### 错误处理

- **错误恢复**：遇到错误时自动跳过并继续处理
- **错误报告**：详细记录处理过程中的错误
- **回滚功能**：支持撤销批量操作

### 备份和恢复

#### 自动备份

插件在执行批量操作前会询问是否创建备份：

1. **备份内容**：整个工作表的副本
2. **备份命名**：原表名_Backup_时间戳
3. **备份位置**：同一工作簿中

#### 手动恢复

如果需要恢复到操作前的状态：

1. 找到备份工作表
2. 复制需要的数据
3. 粘贴到原工作表中

## 最佳实践

### 数据准备

1. **整理数据源**
   - 确保批注数据完整、准确
   - 清理多余的空格和特殊字符
   - 统一数据格式

2. **规划区域**
   - 明确目标区域和数据源区域
   - 确保区域大小匹配
   - 避免重叠区域

### 模板使用

1. **创建标准模板**
   - 为不同类型的批注创建专用模板
   - 使用描述性的模板名称
   - 定期整理和更新模板

2. **团队协作**
   - 导出常用模板供团队使用
   - 建立模板使用规范
   - 定期同步模板库

### 性能优化

1. **分批处理**
   - 对于超过1000个单元格的操作，建议分批进行
   - 关闭不必要的计算和屏幕更新

2. **内存管理**
   - 处理完成后及时清理临时数据
   - 定期保存工作簿

### 质量控制

1. **预览检查**
   - 在小范围内测试批注效果
   - 检查占位符是否正确替换
   - 验证格式设置是否符合预期

2. **备份策略**
   - 重要数据操作前必须备份
   - 定期保存工作进度
   - 使用版本控制管理重要文件

## 常见问题

### 功能相关

**Q: 可以一次处理多少个单元格？**
A: 理论上没有限制，但建议单次处理不超过10000个单元格以确保性能。

**Q: 支持哪些文件格式导入？**
A: 支持.txt、.csv、.xlsx、.xls格式的文件。

**Q: 占位符区分大小写吗？**
A: 是的，占位符必须使用大写字母，如{CELL}而不是{cell}。

**Q: 可以批量删除批注吗？**
A: 当前版本不支持批量删除，这个功能在后续版本中会添加。

### 性能相关

**Q: 处理大量数据时Excel变慢怎么办？**
A: 可以关闭自动计算，分批处理数据，或者在处理期间不要操作Excel。

**Q: 如何取消正在进行的批量操作？**
A: 点击对话框中的"取消"按钮，插件会安全地停止操作。

### 错误处理

**Q: 遇到"区域格式不正确"错误怎么办？**
A: 检查区域地址格式，确保使用正确的Excel区域表示法，如A1:B10。

**Q: 文件导入失败怎么办？**
A: 检查文件是否存在、格式是否正确、是否被其他程序占用。

**Q: 批注显示不完整怎么办？**
A: 调整批注大小设置，或启用自动调整大小功能。

### 兼容性

**Q: 支持哪些Excel版本？**
A: 支持Excel 2016及以上版本，包括Microsoft 365。

**Q: 在Mac上可以使用吗？**
A: 当前版本仅支持Windows系统，Mac版本正在开发中。

**Q: 与其他插件冲突怎么办？**
A: 尝试禁用其他插件，或联系技术支持获取兼容性解决方案。

## 技术支持

如果您在使用过程中遇到问题：

1. **查看帮助**：点击插件中的"帮助"按钮
2. **查看日志**：检查 `%APPDATA%\BatchCommentAddin\logs\` 中的日志文件
3. **提交问题**：访问 [GitHub Issues](https://github.com/yourusername/BatchCommentAddin/issues)
4. **联系支持**：发送邮件至 support@example.com

## 更新日志

查看 [CHANGELOG.md](../CHANGELOG.md) 了解最新功能和改进。

---

感谢使用Excel批量批注插件！如果您觉得这个插件有用，请给我们的 [GitHub项目](https://github.com/yourusername/BatchCommentAddin) 点个星⭐。